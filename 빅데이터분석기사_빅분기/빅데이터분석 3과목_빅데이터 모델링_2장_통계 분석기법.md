## 회귀분석
### 회귀분석의 개념
*개념, 오차항 가정, 결과 해석 등 다양한 문제 출제*
- 하나 혹은 그 이상의 원인(독립변수)이 결과(종속변수)에 미치는 영향을 추정하여 식으로 표현할 수 있는 통계기법
- 변수들 사이의 인과관계를 밝히고 모형을 적합하여 관심있는 변수를 예측하거나 추론하기위해 사용하는 분석방법
- 독립변수의 개수가 하나 > 단순선형회귀
- 독립변수의 개수가 두개 이상 > 다중선형회귀

가. 회귀분석에 적합한 데이터 형태
- 회귀분석의 입력 데이터에서 종속변수와 입력변수는 계량형 자료여야 한다. 하지만 독립변수의 경우 명목척도로 측정된 범주형 자료가 사용될 수 있다. 이 때는 독립변수를 가변수(더미변수)로 변환해야 한다

나. 회귀분석의 변수
- 영향을 주는 변수(x) = 설명변수, 독립변수, 예측변수
- 영향을 받는 변수(y) = 반응변수, 종속변수, 결과변수

다. 선형회귀분석의 가정
- **독립변수와 종속변수 간의 선형성** : 입력변수와 출력변수의 관계가 선형이어야 한다(가장 중요한 가정)
- **오차의 등분산성** : 오차란 종속변수의 예측값과 실제 관측값 간의 차이를 의미함. 오차의 등분산성이란 오차의 분산은 독립변수 값과 무관하게 일정해야 한다는 가정이다. 잔차플롯(산점도)을 그렸을 때 잔차와 독립변수간 아무런 관련성이 없게 점들이 무작위적으로 고르게 분포되어야 등분산성 가정을 만족하게 된다
- **오차의 정규성** : 오차의 분포가 정규분포를 만족해햐 함. Q-Q plot, Kolmogorov-Smirnov 검정, Shapiro-Wilk 검정 등을 활용하여 정규성 확인
- **오차의 독립성**: 오차들은 서로 독립적이어야 함. 예측값의 변화에 따라 오차항이 특정한 패턴을 가져서는 안된다

//알아두기. 오차와 잔차
오차 : 모집단의 실제값과 회귀분석을 통해 적합된 값의 차이
잔차 : 표본에서 나온 관측값과 회귀분석을 통해 적합된 값의 차이
모집단의 실제값은 알기 힘들기 때문에 회귀모형에서 정확한 오차항은 측정하기 어렵다
따라서 잔차를 오차항의 관찰값으로 해석하여 오차항에 대한 가정들의 성립여부를 조사한다

라. 그래프와 통계량을 활용한 선형회귀분석의 가정 검토
1) 선형성
- 선형회귀모형에서는 그래프와 같이 설명변수(x)와 반응변수(y)가 선형적 관계에 있음이 전제되어야 한다
![[Pasted image 20240319093548.png]]![[Pasted image 20240319093722.png]]

2) 등분산성
	가) 등분산성을 만족하는 경우
	- 설명변수(x)에 대한 잔차의 산점도를 그랬을 때, 위의 그림과 같이 설명변수 값에 관계없이 잔차들의 변동성(분산)이 일정한 형태를 보이면 선형회귀분석의 가정 중 등분산성을 만족한다고 볼 수 있다
	나) 등분산성을 만족하지 못하는 경우
	1. 설명변수(x)가 커질수록 잔차의 분산이 줄어드는 이분산의 형태
	2. 2차항 설명변수 필요
	3. 새로운 설명변수 필요
	- ![[Pasted image 20240319093736.png]]

3) 정규성
- Q-Q plot을 출력했을 때, 잔차가 대각방향의 직선의 형태를 지니고 있으면 잔차는 정규분포를 따른다고 할 수 있다.
- 잔차의 분포는 회귀모형으로 도출한 결과와 실제 관측치의 차이이므로 모델이 정교할수록 잔차는 작을 것이고, 그렇지 않다면 그 차이가 클 것이다
- ![[Pasted image 20240319094029.png]]

4) 독립성
- 회귀분석의 주요한 가정 중 오차항이 독립성을 만족하는지를 검정하기 위해서는 더빈 왓슨 검정을 수행함
- 검정 결과 더빈 왓슨 통계량이 2에 가까울수록 오차항의 자기상관이 없음을 의미
- 더빈왓슨 통계량의 값이 0에 가까울수록 양의 상관관계가 있음을 의미
- 4에 가까울 수록 음의 상관관계가 있음을 의미
- 따라서 더빈 왓슨 통계량이 0 혹은 4에 가까울 경우 잔차들간의 상관관계가 있어 회귀식이 부적합함을 의미함

마. 회귀분석의 종류에 따른 가정에 대한 검증
- **단순선형회귀분석** : 입력변수와 출력변수 간의 선형성을 점검하기 위해 산점도 확인
- **다중선형회귀분석** : 데이터가 선형회귀분석의 가정인 선형성, 등분산성, 정규성, 독립성을 모두 만족하는지 확인해야 함

### 단순선형회귀
- 하나의 독립변수가 종속변수에 미치는 영향을 추정할 수 있는 통계기법
- **단순선형회귀란?**  
독립변수 1개, 종속변수도 1개인 선형회귀  
예) 주택 가격이 주택의 크기로만 결정될 경우 주택 크기가 커질수록 가격이 높아짐, 그렇다면 주택 가격은 주택 크기에 대해 선형(직선형태)를 가짐
- ![[Pasted image 20240319094447.png]]

가. 회귀계수의 추정방법(최소제곱법, 최소자승법)
- 회귀분석을 할 때는 최소제곱법(최소자승법)을 이용해 회귀계수를 추정한다. 최소제곱법이란 잔차 제곱합을 최소로 만드는 직선을 찾는 것이다
- **잔차제곱합(RSS)**  
잔차제곱합이란?  
오류값의 제곱을 구해서 더하는 방식, 단순 오차 제곱 합이라고도 함  
즉, 최적의 회귀모델을 만든다는 것은 전체 데이터의 잔차(오류 값)합이 최소가 되는 모델을 만든다는 것임

나. 단순선형회귀분석의 결과 해석
1) 회귀 모형은 통계적으로 유의한가? (F검정)
- 회귀모형의 유의성 검정을 위한 가설
```
귀무가설 : 회귀계수가 0이다 (b1 = 0)
대립가설 : 회귀계수가 0이 아니다(b /= 0)
```
- F-통계량의 p-value가 유의수준 0.05보다 작으면 귀무가설이 기각되어 '회귀계수는 0이 아니다'라는 결론을 얻게 되고, 회귀 모형이 통계적으로 유의하다고 판단할 수 있다. 귀무가설이 기각되지 않으면 회귀계수는 0으로 봐야 한다
- ![[Pasted image 20240319095207.png]]![[Pasted image 20240319095227.png]]
- 분산분석표의 F-통계량은 MSR과 MSE간의 비율로써 이 값이 크다는 것은 잔차들에 의해 설명되는 변동보다 회귀선에 의해 설명되는 변동이 크기 때문에 회귀선이 독립변수(x)와 종속변수(y)와의 관계를 잘 설명한다는 의미가 된다

2) 회귀계수는 통계적으로 유의한가? (t-검정)
 - 회귀분석 수행 시 도출되는 회귀계수 t-통계량은 해당 회귀계수가 통계적으로 얼마나 유의한지를 나타낸다. 만약 t-통계량이 유의하지 않으면 해당 회귀계수는 통계적으로 유의하지 않으므로 사실상 0으로 간주된다
 ```
귀무가설 : i번째 회귀계수가 0이다 (bi = 0)
대립가설 : i번째 회귀계수가 0이 아니다(b /= 0)
```

- 회귀계수에 대한 p-value가 0.05보다 적거나 t-통계량의 절댓값이 2보다 크면 '회귀계수는 0이다'라는 귀무가설을 기각하고, 해당 회귀계수는 통계적으로 유의하다고 판단할 수 있다

3) 모형은 데이터를 얼마나 설명할 수 있는가? (결정계수 확인)
- 결정계수 R^2 는 회귀모형이 데이터를 얼마나 잘 설명하는지를 나타내는 척도.
- 결정계수는 0~1 사이 값을 가지며 추정된 회귀식이 전체 데이터에서 설명할 수 있는 데이터의 비융을 의미함. 따라서 1에 가까운 값을 가질수록 추정된 회귀식의 설명력이 높다고 할 수 있다
- 다변량 회귀분석(다중회귀분석)에서는 독립변수의 유의성과 관계없이 독립변수의 수가 많아지면 결정계수가 높아진다. 이러한 좀을 보완하기 위해 수정된 결정계수를 활용하여 모형의 설명력을 판단한다
![[Pasted image 20240319100345.png]]
4) 모형이 데이터를 작 적합하고 있는가?
- 모형의 잔차를 그래프로 그리고 회귀진단을 수행하여 판단함

https://wikidocs.net/73481
### 다중선형회귀
- 두개 이상의 독립변수가 종속변수에 미치는 영향을 추정하는 통계기법
- 중선형회귀분석, 다변량 회귀분석이라고도 함

가. 검토사항
1) 데이터가 전제하는 가정을 만족시키는가?
- 회귀분석을 수행하고자 하는 데이터의 독립변수와 종속변수간 선형성, 오차의 독립성 / 등분산성 /정규성 등을 만족하고 있는지 확인

2) 다중공선성
- 회귀분석에서 독립변수들 간에 강한 상관관계가 나타나는 문제. 다중 공선성의 문제가 존재하면 정확한 회귀계수의 추정이 곤란함. 따라서 독립변수들 간 상관관계가 있는지를 파악한 후, 다중공선성의 문제가 발생하면 문제가 있는 독립변수를 제거하고나 주성분회귀, 릿지 회귀모형과 같은 다른 추정 방법을 이용하여 문제를 해결한다

- 다중 공선성 검사 방법
	가) 독립변수들 간의 상관계수 구하기
	나) 허용 오차를 구했을 때 0.1 이하면 문제
		허용오차 : 한 독립변수의 분산 중 다른 독립변수들에 의해서 설명되지 않는 부분. 그 값이 작을수록 공선성은 높다고 볼 수 있다. 또한 허용오차는 0~1사이의 값을 가진다
	다) 분산팽창요인(VIF)
		허용오차의 역수로 그 값이 클루록 독립변수들 간의 상관성이 높다. 일반적으로 VIF가 10 이상이면 공선성의 문제가 심각하다고 본다

나. 다중선형회귀분석의 결과 해석
1) 회귀모형은 통계적으로 유의한가? (F-검정)
- 단순선형회귀분석과 마찬가지로 회귀분석의 결과로 산출되는 F-통계량의 p-value가 0.05보다 작으면 해당 회귀식은 통계적으로 유의하다고 볼 수 있다
```
귀무가설 : 모든 회귀계수가 0이다 (b1 = 0)
대립가설 : 모든 회귀계수가 0이 아니다(b /= 0)
```

![[Pasted image 20240319103826.png]]

2) 회귀계수는 통계적으로 유의한가? (t-검정)
 ```
귀무가설 : i번째 회귀계수가 0이다 (bi = 0)
대립가설 : i번째 회귀계수가 0이 아니다(b /= 0)
```
- 회귀계수에 대한 p-value가 0.05보다 작거나 t-통계량의 절댓값이 2보다 크면 'i번째 회귀계수는 0이다'라는 귀무가설을 기각하고, 해당 회귀계수는 통계적으로 유의하다고 판단할 수 있다
- 다중선형회귀분석의 경우 회귀계수의 유의성이 통계적으로 검증된 독립변수들의 조합으로 모형을 생성하여 활용할 수 있다
- 각 독립변수의 영향력에 대한 상대적인 비교는 표준화된 회귀계수를 통해 파악해야 한다. 왜냐하면 여러 독립변수들의 단위가 각각 다를 수 있으며, 비표준화된 회귀계수는 독립변수의 단위를 반영하고 있기 땜ㄴ이다. 표준화된 회귀계수는 입력 데이터를 평균 0, 표준편차 1이 되도록 표준화시킨 데이터로 분석했을 때의 계수이며, 표준화된 회귀계수의 절대값을 비교하여 독립변수의 영향력을 비교해야 한다

3) 모형은 데이터를 얼마나 설명할 수 있는가? (결정계수 확인)
- 결정계수는 추정된 회귀식이 전체 데이터에서 설명할 수 있는 데이터의 비율을 의미하며 0과 1사이의 값을 가진따. 따라서 높은 결정계수를 가질수록 추정된 회귀식의 설명력이 높다고 할 수 있다
- 다변량 회귀분석에서는 독립변수의 유의성과 관계없이 독립변수의 수가 많아지만 결정계수가 높아진다. 이런 점을 보와하기 위해 수정된 결정계수 Ra^2로 모형의 설명력을 판단한다
4) 모형이 데이터를 작 적합하고 있는가?
- 모형의 잔차를 그래프로 그리고 회귀진단을 수행하여 판단함
다. 최적 회귀방정식 선택
- 모형 내 설명변수의 수가 증가할수록 데이터 관리에는 많은 노력이 요구된다. 따라서 상황에 따라 종속변수에 영향을 미치는 유의미한 독립변수들을 선택하여 최직의 회귀방정식을 도출하는 과정이 필요하다
- 변수를 선택할 때는 F-통계량이나 AIC와 같은 특정 기준을 근거로 변수를 제거하거나 선택한다. F-통계량의 유의확률이 유의수준보다 큰 변수는 통계적으로 유의하지 않으므로 제거해야 하고, AIC와 같은 벌점화 기준을 가장 낮게 만드는 변수 조합을 선택해야 한다. 최적의 회귀방정식을 찾기 위해 변수를 선택하기 위한 과정들을 학습해보자

1) 단계적 변수선택

| 종류     | 개념                                                                                                                                                       | 장점                                    | 단점                                                  |
| ------ | -------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------- | --------------------------------------------------- |
| 전진선택법  | 절편만 있는 상수 모형에서 시작하여 중요하다고 생각되는 설명변수부터 차례로 모형에 추가함                                                                                                        | 이해가 쉬움. 변수개수가 많은 경우에도 사용 가능           | 변수값의 작은 변동에도 결과가 크게 달라져 안정성 부족. 한번 선택된 변수는 제거할 수 없음 |
| 후진 제거법 | 모든 독립변수를 포함한 모형에서 출발하여 종속변수에 가장 적은 영향을 주는 변수부터 하나씩 제거하면서 더 이상 제가할 변수가 없을 때의 모형을 선택함                                                                      | 전체 변수들에 대한 정보를 이용                     | 변수 개수가 많은 경우 사용이 어려움. 한번 선택된 변수는 제거할 수 없음           |
| 단계적 방법 | 전진선택법에 의해 변수를 추가하면서 새롭게 추가된 변수에 의해 기존 변수의 중요도가 약화된면 해당변수 제거. 단계별로 변수의 추가와 제거를 수행하면서 기준 통계치를 가장 많이 개선시킬 때까지 반복함. 반대로 모든 변수가 포함된 모델에서 시작해 제거와 추가를 반복할 수 있다 | 모든 변수 조합을 고려하는 방법으로 가정 좋은 변수 조합 선택 가능 | 변수 개수가 많을수록 검증할 회귀분석이 많아 계산량, 계산 시간 증가              |

2) 벌점화된 선택기준
	가) 설명
	- 모형의 복잡도에 따라 벌점을 주는 방식
	- 후보 모형에 대해 AIC나 BIC를 계산했을 때 그 값이 최소가 되는 모형 선택
	- AIC를 활용하는 것이 보편적. 그 밖에 RIC, CIC, DIC가 있다

	나) 공식
	- AIC(Akaike infornation criterion)는 주어진 데이터셋에 대한 통계 모델의 품질을 평가하기 위한 값. 최소의 정보 손실을 갖는 모델을 가장 적합한 것으로 봄
	- BIC(Bayesian information criterion)는 AIC와 유사하지만 변수가 많을 수록 더 많은 페널티를 가하는 성격을 하짐,. 따라서 AIC보다 변수 증가에 더 민감한 특성을 가짐

3) 수정된 결정계수
- 설명변수의 수가 증가하면 결정계수도 함께 증가하는 속성을 가진다. 수정된 결정계수는 변수의 개수가 증가함에 따라 처음에는 감소하다가 점점 안정화되고 나중에는 약간 증가하는 경향을 가진다
- 수정된 결정계수를 이용하여 변수를 선택할 경우, MSE값이 최소인 시점의 모형을 선택하거나 이 값의 최소와 비슷해서 더이상 변수를 추가할 필요가 없는 시점의 모형을 선택하게 된다

1) Mallow's Cp
- 일반적으로는 모델에 변수가 더 많이 추가될수록 잔차제곱합이 작아진다. 따라서 잔차 제곱합이 가장 작은 모델을 선택할 경우 항상 모든 변수를 포함하는 모델이 선택되며, 이는 과적합 문제로 이어질 수 있다
- Mallow's Cp는 모든 변수를 사용한 모형과 p개의 독립변수를 사용한 모형이 얼마나 가까운지를 나타내는 통계량이다. 즉 비슷한 성능을 가진다면 변수의 개수가 적은 더 간단한 모형이 좋기 때문에 Mallow's Cp 통계량을 활용해 모형을 선택할 수 있다
- Mallow's Cp 해석
일반적으로 Cp값이 작고 {p(변수의 개수) + 상수} 에 가까운 모형을 선택한다

| Cp값            | 해석                                                   |
| -------------- | ---------------------------------------------------- |
| Cp값이 p와 비슷한 경우 | bias(편향)가 작고 우수한 모델                                  |
| Cp값이 p보다 큰 경우  | bias가 크고 추가적인 변수가 필요한 모델                             |
| Cp값이 p보다 작은 경우 | Variance(분산)의 증가폭보다 bias의 감소폭이 더 크며, 필요없는 변수가 모델에 있음 |

### 정규화 선형회귀
![[Pasted image 20240319110505.png]] 그냥 웃겨서 가져왔다. 젠장

- 선형회귀계수에 대한 제약조건을 추가하여 모델이 과도하게 최적화되는 현상을 막는 방법
- 오른쪽의 그림에서 모델이 학습데이터를 매우 잘 적합하고 있지만, 미래 데이터가 조금만 바뀌어도 예측값이 과도하게 변할 수 있다
- ![[Pasted image 20240319110546.png]]
- 반면 Optimal 그래프는 정규화를 수행하여 학습데이터에 대한 설명력을 조금은 포기하는 대신 미래 데이터의 변화에 대해 상대적으로 안정된 결과를 낼 수 있다
- ![[Pasted image 20240319110853.png]]
- 이와같이, 모형이 과적합되면 계수의 크기도 과도하게 증가하는 경향이 있다. 따라서 정규화 선형회귀에서는 계수의 크기를 제한하는 방법으로 제약조건을 추가한다
- 정규화 선형회귀에서는 일반적으로 제약조건의 종류에 따라 Ridge 회귀, Lasso 회귀. Elastic Net 회귀 모형이 사용된다

가. 릿지 회귀
- 릿지회귀모형은 가중치들의 제곱합을 최소화하는 것을 제약조건으로 추가하는 기법
- 릿지 회귀모형에서는 가중치의 모든 원소가 0에 가까워지는 것을 원하며, 이를 위해 회귀 모델에 사용하는 규제 방식을 L2규제라고 한다
- 람다는 기존의 잔차 제곱합과 추가적인 제약조건의 비중을 조절하기 위한 하이퍼 모수에 해당한다. 람다가 커지면 가중치의 값들이 작아지며 정규화 정도가 커진다. 람다가 작아지면 정규화 정도가 작아지고 람다가 0이 되면 일반적인 선형회귀모형이 된다

나. 라쏘회귀
- 라쏘회귀모형은 가중치 절대값의 합을 최소화하는 것을 제약조건으로 추가하는 기법.
- 릿지회귀에서는 가중치가 0에 가까워질 뿐, 실제로 0이 되진 않는다. 하지만 라쏘회귀에서는 중요하지 않은 가중치는 0이 될수도 있다
- 라쏘회귀에서 사용하는 규제 방식을 L1규제라고 한다

다. 엘라스틱넷
- 릿지회귀와 라쏘회귀를 결합한 모델
- 가중치 절댓값의 합과 제곱합을 동시에 제약조건으로 가지는 모형임으로 람다1와 람다2라는 두 대의 하이퍼 모수를 가진다

### 일반화 선형회귀
- 회귀분석은 연속형의 종속변수가 정규분포를 따른다는 정규성을 가정한다. 하지만 종속변수가 범주형 자료이거나 정규성을 만족하지 모하는 경우 종속변수를 적절한 함수로 변화시켜 f(x)로 정의한 후, 이 f(x)의 독립변수를 선형 결합으로 모형화하는 '일반화 선형모형'을 이용한다

| 랜덤성분   | 종속변수 y의 확률분포를 규정하는 성분                  |
| ------ | -------------------------------------- |
| 체계적 성분 | y의 기댓값인 E(y)를 정의하는 설명변수들 간의 선형 결합(선형식) |
| 연결함수   | 랜덤성분과 체계적 성분을 연결하는 함수                  |
glm 분석방법

| 랜덤성분<br>(반응변수) | 연결함수                  | 정준연결함수   | 체계적성분<br>(설명변수)  | Model(분석방법)           |
| -------------- | --------------------- | -------- | ---------------- | --------------------- |
| Nomal          | Identity              | Identity | 연속형              | 선형회귀모형                |
|                |                       |          | 범주형              | 분산분석<br>또는 선형회귀분석     |
|                |                       |          | Mixed<br>(연속+범주) | 선형회귀모형                |
| Binomial       | Logistic              | Logistic | Mixed            | 로지스틱회귀모형<br>또는 이항회귀모형 |
|                | complementary log-log |          |                  | 이항회귀모형                |
|                | Probit                |          |                  |                       |
| Poisson        | Log                   | Log      |                  | 포아송회귀모형               |
| Gamma          | Log                   | Inverse  |                  | 감마회귀모형                |
|                | Inverse               |          |                  |                       |
- 일반화 선형회귀는 선형회귀와 마찬가지로 독립변수가 종속변수에 미치는 영향의 정도를 회귀계수를 통해 설명하며, 독립변수들 간의 영향을 보정한 다변량 분석이 가능함

### 회귀분석의 영향력 진단
- 영향력 진단 : 적합된 회귀모형의 안전성을 평가하는 통계적 방법
- 자료에서 특정 관측치가 제외됨에 따라 분석 결과의 주요 부분에 많은 변동이 있다면 안전성이 약하다고 판단함
- 영향점 : 선형회귀분석에서 회귀직선의 기울기에 영향을 크게 주는 점
- 영향력 진단 방법

| 영향력<br>진단 방법    | 설명                                                                                                         | 공식  |
| --------------- | ---------------------------------------------------------------------------------------------------------- | --- |
| Leverage H      | 레버리지는 Hat Matrix의 i번째 대각원소로 관측치가 다른 관측치 집단으로부터 떨어진 정도를 의미. 2 x (p + 1) / n 보다 크면 영향치이거나 이상치라고 본다           |     |
| Cook's Distance | 쿡의 거리는 Full Model에서 i번째 관측치를 포함하여 계산한 적합치와 i번째 관측치를 포함하지 않고 계산한 적합치 사이의 거리. 쿡의 거리가 기준값인 1보다 클 경우에 영향치로 간주함 |     |
| DFBETAS         | DFBETAS의 절대값이 커지면 i번째 관측치가 영향치 혹인 이상치일 가능성이 높다. 기준값은 2나 2루트n을 사용하며, DFBETAS가 기준값보다 클 경우 영향치로 간주함           |     |
| DFFITS          | i번째 관측치 제외 시 종속변수 예측치의 변화정도를 측정한 값. DFFITS의 절대값이 기준값인2 x (p + 1) / n보다 클수록 영향치 가능성이 높다고 본다                 |     |


## 범주형 자료 분석
### 범주형 자료 분석
*분할표, 상대위험도, 오즈비 // 적합성/독립성/동질성 검정*
가. 개요
- 범주형 자료분석은 분석에 사용되는 변수들이 범주형일 때 사용하는 분석 방법론
- 설명변수와 반응변수에 따른 범주형 자료 분석 방법론 분류

| 설명변수   | 반응변수   | 통계분석방법                |
| ------ | ------ | --------------------- |
| 범주형 자료 | 범주형 자료 | - 분할표 분석<br>- 카이제곱 검정 |
|        | 연속형 자료 | - T-검정<br>- 분산분석      |
| 연속형 자료 | 범주형 자료 | - 로지스틱 회귀분석           |

### 분할표 분석
가. 개요
- 분할표 : 여러 개의 범주형 변수를 기준으로 빈도를 표 형태로 나타낸 것
- ![[Pasted image 20240319133434.png]]
- 범주형 변수가 1일 때는 1원 분할표, 2개일 때는 2월 분할표, 3개 이상일 때는 다원 분할표
- 분할표의 행은 설명변수, 열은 반응변수를 입력하고 범주형 자료를 분석할 때는 이 분할표를 기반으로 여러 가지 검정을 수행할 수 있다

나. 상대위험도(Relative Risk)
- 관심 집단의 위험률 / 비교 집단의 위험률을 의미. 여기서 위험률이란 특정 사건이 발생할 비율을 의미
- ex. 위험인자 노출된 암환자 확률 / 노출되지 않은 암환자 확률이 상대적 위험도이다
- ![[Pasted image 20240319133656.png]]![[Pasted image 20240319133709.png]]

다. 오즈비(Odds Ratio)
- 오즈란 성공확률/실패확률로 성공할 확률이 실패할 확률의 몇 배인지를 나타냄
- 오즈비란 오즈의 각 범주별 비율로 정의됨
![[Pasted image 20240319160816.png]]

### 교차분석
가. 카이제곱 X^2 검정이란?
- 범주형 자료(명목/서열 수준)인 두 변수 간의 관계를 알아보기 위해 실시하는 분석 기법
- 적합성 검정, 독립성 검정, 동질성 검정에 사용되며 **카이제곱 검정 통계량**을 이용한다

나. 교차표
- 두 변수의 각 범주를 교차하여 데이터의 관측도수(빈도)를 표 형태로 나타낸 것
- ![[Pasted image 20240319161805.png]]

### 적합성 검정
가. 적합성 검정이란?
- 실험에서 얻어진 관측값들이 예상한 이론과 일치하는지 아닌지를 검정하는 방법
- 관측값들이 어떠한 이론적 분포를 따르고 있는지를 알아볼 수 있다
- 모집단 분포에 대한 가정이 옳게 됐는지를 관측 자료와 비교하여 검정하는 것

나. 가설 설정
- n개의 표본자료를 k개의 범주로 분류한 뒤, 각 범주의 관측도수와 주어진 확률 분포에 대하 각 범주가 속하는 기대도수들이 적합하는지의 여부를 검정하는 것

```
귀무가설 : 실제 분포와 이론적 분포 간에는 차이가 없다. (두 분포가 일치한다)
대립가설 : 실제 분포와 이론적 분포 간에는 차이가 있다. (두 분포가 일치하지 않는다)
```

다. 검정통계량
![[Pasted image 20240319162344.png]]

- X^2 통계량 값이 큰 경우 : 관찰 도수와 기대도수의 차이가 크며, **적합도가 낮다** 즉, 일치한다고 볼 수 없다
- X^2 통계량 값이 작은 경우 : 관찰 도수와 기대도수의 차이가 작으며, **적합도가 높다** 즉, 일치한다고 볼 수 있다

라. 자유도
- df = k -1
- k = 범주의 개수

### 독립성 검정
가. 독립성 검정이란?
- 모집단이 두 개의 변수 A, B에 의해 범주화되었을 때, 이 두 변수들 사이의 관계가 독립인지 아닌지를 검정하는 것
- 검정 통계량 값을 계산할 때는 교차표를 활용한다

//알아두기. 독립의 조건
1) 독립이란?
- 통계이론에서 독립은 A와 B라는 사건이 있을 때, 한 사건이 일어날 확률이 다른 사건이 일어날 확률에 영향을 미치지 않는 것
- 동전 던지기는 전 사건이 현 사건에 영향을 주지 않음. 이런 경우 서로 독립임
2) 독립의 공식
- 사건 A와 B가 서로 독립일 때 A와 B가 동시에 일어날 확률은 각 사건이 일어날 확률의 곱과 같다
- 즉, A와 B가 독립이면 P(A교집합B) = P(A) X P(B) 라는 식이 성립

- 변수가 '가'이면서 'True'일 확률은 80/280 * 100/280

|       | 가                                              | 나   | 다   | 합                                               |
| ----- | ---------------------------------------------- | --- | --- | ----------------------------------------------- |
| True  | 30                                             | 20  | 50  | <mark style="background: #ABF7F7A6;">100</mark> |
| False | 50                                             | 70  | 60  | 180                                             |
| 합     | <mark style="background: #ABF7F7A6;">80</mark> | 90  | 110 | <mark style="background: #ABF7F7A6;">280</mark> |

나. 가설 설정
- 모집단을 범주화하는 기준이 되는 두 변수 A, B가 서로 독립적으로 관측값에 영향을 미치는 지의 여부를 검정하는 것
```
- 귀무가설 : 두 변수 사이에는 연관이 없다(독립이다)
- 대립가설 : 두 변수 사이에는 연관이 있다(종속이다)
```

다. 검정통계량
- X^2 통계량 값이 큰 경우 : 두 변수 사이에는 연관이 있다 즉, 두 변수는 **종속관계**이다
- X^2 통계량 값이 작은 경우 : 두 변수 사이에는 연관이 있다 즉, 두 변수는 **독립관계**이다

라. 자유도
- df = (R-1)(C-1)
- R : 행의 수, C : 열의 수


### 동질성 검정
가. 동질성 검정이란?
- 모집단이 임의의 변수에 따라 R개의 속성으로 범주화되었을 때, R개의 부분 모집단에서 추출한 각 표본인 C개의 범주화된 집단의 분포가 서로 동일한지를 검정하는 것

나. 가설 설정
- j = 1,2,...,c
- 귀무가설 : P1j = p2j = ... = Prj(모든 Pnj(n=1,2,...,r)는 동일하다)
- 대립가설 : Not H0(Pnj (n=1,2,...,r)중 다른 값이 하나 이상 존재한다)

다. 검정통계량
- X^2 통계량 값이 큰 경우 : Pnj(n=1,2,...,r) 중 **다른 값**이 하나 이상 **존재**한다
- X^2 통계량 값이 작은 경우 : 모든 Pnj(n=1,2,...,r)는 **동일**하다

라. 자유도
- df = (R-1)(C-1)
- R : 행의 수, C : 열의 수

![[Pasted image 20240319163100.png]]


## 다차원 척도법
### 다차원 척도법
- 객체 간 근접성을 시각화하는 통계기법
- 군집 분석과 같이 개체들을 대상으로 변수들을 측정한 후에 대체들 사이의 유사성/비유사성을 측정하여 개체들을 2차원 공간상에 점으로 표현하는 분석방법
- 개체들을 2차원 또는 3차원 공간상에 점으로 표현하여 개체들 사이의 집단화를 시각적으로 표현하는 분석방법

### 다차원 척도법의 목적
- 데이터 속에 잠재해 있는 패턴, 구조를 찾아냄
- 그 구조를 소수 차원의 공간에 기하학적으로 표현
- 데이터 축소의 목적. 데이터에 포함되어 있는 정보를 발견하기 위한 탐색수단으로서 이용
- 다차원 척도법 결과를 데이터가 만들어진 현상이나 과정에 고유의 구조로서 의미를 부여

### 분석방법
- 개체들의 거리 계산에는 유클리드 거리행렬을 활용함
- ![[Pasted image 20240319164646.png]]
- 관측 대상들의 상대적 거리의 정확도를 높이기 위해 적합 정도를 스트레스 값으로 나타냄
- 각 개체들을 공간상에 표현하기 위한 방법은 부적합도 기준으로 STRESS나 S-STRESS 사용
- 최적모형의 적합은 부적합도를 최소로 하는 반복알고리즘을 이용하며, 이 값이 일정 수준 이하가 될 때 최종적으로 적합된 모형으로 제시함
- ![[Pasted image 20240319164909.png]]
- 최적모형의 적합은 부적합도를 최소로 하는 방법으로 일정 수준 이하로 될 때까지 반복해서 수행
- ![[Pasted image 20240319165007.png]]

### 다차원 척도법의 종류
가. 계량적 MDS
- 데이터가 구간척도나 비율척도인 경우 활용(전통적인 다차원척도법). N개의 케이스에 대해서 p개의 특성변수가 있는 경우, 각 개체들간의 유클리드 거리행렬을 계산하고 개체들간의 비유사성 S(거리제곱 행렬의 선형함수)를 공간상에 표현함
- ![[Pasted image 20240319165314.png]]

나. 비계량적 MDS
- 데이터가 순서척도인 경우 활용. 개체들간의 거리가 순서로 주어진 경우에는 순서척도를 거리의 속성과 같도록 변환하여 거리를 생성한 후 적용
- ![[Pasted image 20240319165558.png]]


## 다변량 분석
*주성분분석, 요인분석, 판별분석 개념과 특징*
### 주성분 분석
가. 개념
- 데이터에 여러 변수들이 있을 때 **서로 상관성이 높은 변수들의 선형결합**으로 이루어진 **주성분(Principal Component)** 이라는 새로운 변수를 만들어 변수들을 요약하고 축소하는 기법
- 변수 x와 z로 y를 예측하고자 할 때, x=3a, z = a+1, y = 2x+ z와 같은 관계가 성립된다면 굳이 x와 z라는 두 변수는 사용하지 않고 변수 a로만 y를 예측하는 것이 더 좋을 것이다. 이와 같이 여러 변수의 선형조합으로 만들어진 주성분을 통해 변수들을 축소할 수 있다
- 주성분분석을 할 때, **첫 번째 주성분으로 전체 변동을 가장 많이 설명** 할 수 있도록 하고, 두 번째 주성분으로는 첫 번째 주성분이 설명하지 못하는 나머지 변동을 정보 손실 없이 가장 많이 ㅓㄹ명할 수 있도록 변수들의 선형조합을 만든다. **각 주성분은 서로 독립** 인 것을 원칙으로 한다(ㅏㅇ관계수 = 0)

나. 목적
- 여러 변수들 간에 내재하는 상관관계, 연관성을 이용해 **소수의 주성분으로 차원을 축소** 함으로써 데이터를 이해하고 관리하기 쉽게 해준다
- ** 다중공선성** 이 존재하는 경우, **상관성이 없는(적은) 주성분으로 변수를 축소** 하여 모형 개발에 활용할 수 있다. 
- 회귀분석이나 의사결정나무 등의 모형 개발 시 입력변수들 간의 상관관계나 높은 다중공선성이 존재할 경우 모형이 잘못 만들어져 문제가 생길 수 있음
- 주성분 분석을 통해 변수 차원을 축소한 후 **군집분석을 수행하면 군집화 결과와 연산속도를 개선** 할 수 있다
- 주성분분석으로 기계에서 나오는 다량의 센서 데이터의 차원을 축소한 후, 분포나 추세의 변화를 분석하여 기계의 고장징후를 사전에 파악하는데 활용하기도 한다

//알아두기. 주성분의 선택
- 2차원 좌표평면상에 아래 그림과 같이 n개의 데이터가 양의 상관관계를 가지고 분포되어 있을 때, 이 분포 특성을 가장 잘 설명할 수 있는 주성분은 ? 
- 그 것은 **데이터의 분산을 가장 잘 표현하고 있는 축 P1에 해당** 하며, 주성분 분석에서는 바로 이 축을 **첫 번째 주성분** 이라고 생각한다
- 다음으로 첫 번째 주성분과 관련성이 없으면서 나머지 데이터를 가장 잘 설명할 수 있는 성분은 **축 P1와 수직이면서 남은 데이터의 분산을 가장 잘 표현하는 축 P2** 이다. 축 B는 **두 번째 주성분**에 해당된다
- ![[Pasted image 20240319170526.png]]

다. 주성분의 선택
1) 기여율
- 주성분은 여러 변수들의 선형결합으므로, 각 변수에 내재되어 있는 중요한 정보의 손실이 있을 수도 있다. 따라서 '주성분 기여율'을 사용하여 주성분이 데이터를 얼마나 잘 설명할 수 있는지를 평가한다
- **주성분 기여율**은 원 변수의 총 변동(각 변수들의 분산값 총합)분의 주성분 변수의 분산으로, 총 변동에 대한 **주성분의 설명력을 의미**한다
- 주성분의 분산이 전체 데이터의 흩어진 정도와 비슷하다면 해당 주성분은 적절하다고 판단될 수 있다. 기여율은 **1에 가까울수록 적절하고 0에 가까울수록 데이터에 대한 설명력이 떨어진다고 판단** 한다
- 첫 번째 주성분부터 파례대로 기여율을 합한 **누적 기여율이 85% 이상이 되면 해당 지점까지를 주성분의 수로 결정** 한다. 
- ![[Pasted image 20240319171256.png]]

2) 스크리 산점도
- 주성분을 x축, 각 주성분의 고유값(주성분의 분산)을 y축에 둔 그래프
- **고유치가 급격히 완만해지는 지점의 바로 전 단계로 주성분의 수를 선택**
- ![[Pasted image 20240319171403.png]]

### 요인분석
가. 개념
- 여러 개의 변수들로 일어진 데이터에서 **변수들 간의 상관관계를 고려하여 서로 유사한 변수들을 묶어 새로운 잠재요인들을 추출해내는 분석방법**
- 변수를 축소하고 데이터를 요약하는 데 사용
- 국 영 중 수 물 음 미 의 7개 변수를 /국 영 중/[언어능력], /수, 물/[수리능력], 음 미[예체능]과 같이 새로운 요인들로 구성 해낼 때 요인 분석을 사용
- 요인분석을 수행하기 위해서는 변수가 간격척도 혹은 비율척도로 측정되어야 하며, 표본(관측치)의 크기는 최소 50개 이상, 100개 이상이 바람직함

나. 주성분분석과 요인분석

|            | 주성분분석                                               | 요인분석                                             |
| ---------- | --------------------------------------------------- | ------------------------------------------------ |
| 공통점        | 원데이터를 활용하여 몇 개의 새로운 변수를 생성                          | 변수축소 및 데이터 요약에 사용                                |
| 생성 변수의 수   | 통상적으로 2개                                            | 지정된 개수 없음                                        |
| 생성 변수의 이름  | 제1주성분, 제2주성분                                        | 분석가가 지정                                          |
| 생성 변수들의 관계 | 제2주성분이 가중 중요, 그 다음으로 제2주성분                          | 대등한 관계 (어떤 것이 더 중요하다는 개념이 없음)                    |
| 분석방법 의미    | 목표변수를 잘 예측/분류하기 위해 기존 변수들의 선형결합으로 이루어진 몇개의 주성분을 찾아냄 | 목표변수를 고려하지 않고 주어진 변수들을 비슷한 셩격으로 묶어서 새로운(잠재)변수 생성 |

다. 요인분석의 용어

| 용어     | 설명                                                                                                                       |
| ------ | ------------------------------------------------------------------------------------------------------------------------ |
| 요인     | - 상관계수가 높은 변수들을 묶어 새롭게 생성한 변수집단                                                                                          |
| 요인 적재값 | - 변수와 해당 요인간의 **상관계수**<br>- 요인 적재값의 제곱은 해당 변수가 요인에 의해 설명되는 분산의 비율을 의미                                                    |
| 요인 행렬  | - 요인들에 대한 모든 변수의 요인 적재값을 모은 행렬                                                                                           |
| 고유값    | - 각 요인에 대한 모든 변수들의 **요인 적재값 제곱의 합**<br>- 해당 요인이 설명할 수 있는 변수들의 분산 총합으로, 변수 속 정보(분산)가 어떤 요인에 의해 어느정도 설명될 수 있는지를 나타내는 비율    |
| 공통성    | - 여러 요인이 설명할 수 있는 한 변수의 분산의 양을 백분율로 나타낸 것<br>- 한 변수의 공통성은 **추출된 요인들이 그 변수의 정보(분산)를 얼마만큼 설명할 수 있는지를 의미**하며, 0과 1사이의 값을 가짐 |

라. 요인추출 방법
- **주성분분석** : 변수들로부터 요인을 추출하는 방식으로, 전체 분산을 토대로 요인을 추출함. 요인분석에서 가장 많이 사용
- **공통요인분석** : 잠재요인으로부터 변수들이 산출된 것으로 보는 방식으로, 공통 분산만을 토대로 요인을 추출함

마. 요인의 수 결정
- 고유값을 기준으로 할 때는, **고유값이 1이상에 해당되는 요인들을 추출**
- 스크리 도표 활용
- 경우에 따라 추출할 요인의 수를 사전에 정의한 후 요인분석을 수행할 수 있다

//알아두기. 요인분석의 절차

| 1. 데이터 입력                                                                                                                                                                                           |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 2. 상관계수 산출                                                                                                                                                                                          |
| - 동질적이거나 유사한 변수들을 하나의 요인으로 나타내기 위해 변수들 간의 상관계수를 계산                                                                                                                                                  |
| 3. 요인 추출                                                                                                                                                                                            |
| - 주성분분석, 공통요인분석으로 요인을 추출하고, 고유값과 스크리도표등으로 적절 요인 수 선택                                                                                                                                                |
| 4. 요인 적재량 산출                                                                                                                                                                                        |
| 5. 요인 회전                                                                                                                                                                                            |
| - 최초 요인행렬은 변수들의 분산을 어느정도는 설명할 수 있지만, 요인과 각 변수들 간의 관계를 명확하게 나타내지 않는다. 원활한 요인 해석과 의미있는 요인패턴(변수와 요인의 상관행렬)을 찾기 위해 분산을 재분배시키는 '요인회전' 단계는 매우 중요함<br>- 요인회전의 종류 : 직각회전(쿼티맥스, 베리맥수, 미쿼맥스)과 비직각회전(오블리민)이 있다 |
| 6. 생성된 요인 해석                                                                                                                                                                                        |
| 7. 요인점수 산출                                                                                                                                                                                          |
| 관측치별 요인 점수는 요인점수 계수와 표준화된 관측치의 곱으로 구하며, 요인별로 이 값을 합하면 요인별 요인점수가 된다<br>- 요인점수를 산출하는 방법에는 회귀분석(요인값과 추정된 요인값 간 차이 제곱의 합이 최소가 되게 함), Bartlett(요인들의 제곱합이 최소가 되게 함) 등이 있다                                 |

### 판별분석
가. 개념
- 분류 기법 중 하나로 집단에 대한 정보로부터 집단을 구별할 수 있는 판별함수 혹은 판별규칙을 만들고, 새로운 개체가 어느 집단에 속하는지를 판별하여 분류하는 다변량 기법
- 집단에 대한 정보를 이용한 탐색적인 통계기법
- 판별분석은 간격척도 혹은 비율척도로 특정된 독립변수를 이용해 종속변수는 명목척도 혹은 서열척도로 측정된 종속변수를 분류하는데 사용됨
- 종속변수의 집단 수가 2개인 경우 판별분석이라 하며, 종속변수의 집단 수가 3개 이상인 경우 다중판별분석이라 함

나. 판별식의 도출
- 판별분석에서는 그룹 내 분산에 비하여 그룹 간 분산의 차이를 최대화하는(즉, 분류되어 있는 집단 간의 차이를 의미있게 설명해 줄 수 있는) 독립변수들의 계수를 찾아내며, 독립변수들의 선형결합을 판별함수 혹은 판별식이라고 한다
- ![[Pasted image 20240319173835.png]]
- 판별함수는 '집단의 수 -1'과 '독립변수의 수' 중 더 작은 값만큼 만들어지며, 첫 번째로 계산된 판별식이 집단을 가장 잘 구분해준다

다. 판별분석의 가정
- 독립변수는 다변량 정규분포를 이룬다. 다중 정규성 가정을 충족하지 않는 데이터로 판별분석을 수행할 시 판별함수 추정에 문제가 발생할 수 있으며 이 경우 다중 정규성 가정이 엄격하게 요구되지 않는 로지스틱 회귀분석을 사용할 수 있다
- 종속변수에 의해 범주화되는 그룹들의 분산-공분산행렬이 동일해야 한다. 이 가정이 충족되지 못하는 경우에는 보다 큰 분산-공분산 행렬을 갖는 그룹에 많은 관측치가 분류되는 문제점 발생

라. 판별함수에 포함될 독립변수의 선택방법
- 동시입력방식 : 모든 독립변수들에 대한 계수를 동시에 계산
- 단계입력방식 : 판별력이 높은 순서로 변수가 입력되어 추정이 이루어짐

마. 적합도 평가
- 판별함수의 판별력에 대한 통계적 유의성 검정을 위해 가장 흔히 사용되는 값은 Wilk's lamda이며 x^2 검증 실시
- 판별함수의 전반적인 적합도 검정을 위해서는 hit ratio를 확인함. 정확히 분류된 대상의 수를 전체 대상의 수로 나눈 값으로 0과 1 사이의 값을 갖는다
- 판별함수의 판별력이 통계적으로 유의하다고 나타나더라도 hit ratio가 낮으면 그 판별함수의 판별력은 좋다고 판단하기 힘들다

## 시계열 분석
*정상성에 대한 문제와 모형의 특징*
### 시계열 자료
가. 개요
- 시간의 흐름에 따라 관찰된 값
- 시계열 데이터의 분석을 통해 미래의 값을 예측하고 경향, 주기, 계절성 등을 파악하여 활용할 수 있다

나. 종류
1) 비정상성 시계열 자료
- 다루기 어려운 자료로 대부분 이에 해당함

2) 정상성 시계열 자료
- 비정상 시계열을 핸들링해 다루기 쉬운 시계열 자료로 변환한 자료

### 정상성
- 시계열의 확률적인 성질들이 시간의 흐름에 따라 변하지 않는 것
- 시계열 분석을 하기 위해서는 정상성을 만족해야 함
- 정상성의 조건
	가) 평균이 일정
	- 모든 시점에 대해 일정한 평균을 가진다
	- 평균이 일정하지 않은 시계열은 차분을 통해 정상화

	나) 분산이 일정
	- 분산도 시점에 의존하지 않고 일정해야 함
	- 분산이 일정하지 않을 경우 변환을 통해 정상화

	다) 공분산도 단지 시차에만 의존, 특정 시점인 t, s에는 의존하지 않는다

// 알아두기. 차분이란?
- 차분은 현시점 자료에서 전 시점 자료를 빼는 것이다
- 일반차분 : 바로 전 시점의 자료를 빼는 방법
- 계절차분 : 여러 시점 전의 자료를 빼는 방법, 주로 계절성을 갖는 자료를 정상화하는 데 사용

	라) 정상시계열의 특징
	- 정상시계열은 어떤 시점에서 평균과 분산 그리고 특정한 시차의 길이를 갖는 자기공분산을 측정하더라도 동일한 값을 갖는다.
	- 정상시계열은 항상 그 평균값으로 회귀하려는 경향이 있으며, 그 평균값 주변에서의 변동은 대체로 일정한 폭을 갖는다
	- 정상시계열이 아닌 경우 특정 기간의 시계열로부터 얻은 정보를 다른 시기로 일반화할 수 없다

### 시계열자료 분석방법
가. 분석방법
- 회귀분석, Box-Jenkins, 지수평활법, 시계열 분해법 등

| 수학적이론모형 | 회귀분석(계량경제)방법, Box-Jenkins방법               |
| ------- | ----------------------------------------- |
| 직관적 방법  | 지수평활법, 시계열 분해법으로 시간에 따른 변동이 느린 데이터 분석에 이용 |
| 장기 예측   | 회귀분석방법 활용                                 |
| 단기 예측   | Box-Jenkins, 지수평활법, 시계열 분해법               |

나. 자료 형태에 따른 분석방법
1) 일변량 시계열 분석
- Box-Jenkins(ARMA), 지수 평활법, 시계열 분해법, 시간을 설명면수로 한 회귀모형, 주가/소매물가지수 등 하나의 변수에 관심을 갖는 경우의 시계열 분석

2) 다중 시계열 분석
- 계량 경제 모형, 전이함수모형, 개입분석, 상태공간 분석, 다변량 ARIMA등이 해당하며 여러개의 시간에 따른 변수들을 활용하는 시계열 분석

//알아두기. 계량경제란?
- 시계열 데이터에 대한 회귀분석 (ex. 이자율, 인플레이션이 환율에 미치는 요인)

다. 이동평균법
1) 개념
- 과거로부터 현재까지의 시계열 자료를 대상으로 일정기간별 이동평균을 계산하고 이들의 추세를 파악하여 다음 기간을 예측하는 방법
- 시계열 자료에서 계절변동과 불규칙변동을 제거하여 추세변동과 순환변동만 가진 시계열로 변환하는 방법으로도 사용
- ![[Pasted image 20240319181248.png]]

2) 특징
- 간단하고 쉽게 미래 예측 가능, 자료의 수가 많고 안정된 패턴을 보이는 경우 예측 품질 높음
- 특정 기간 안에 속하느 ㄴ시계열에 대해서는 동일한 가중치 부여
- 일반적으로 시계열 자료에 뚜렷한 추세가 있거나 불규칙 변동이 심하지 않은 경우에는 짧은 기간(m의 개수 적음)의 평균을 사용하고, 불규칙 변동이 심한 경우 긴 기간(m 개수 많음)의 평균 이용
- 가장 중요한 것은 적절한 기간을 사용하는 것 = 적절한 m 개수 결정

라. 지수평활법
1) 개념
- 일정기간의 평균을 이용하느 ㄴ이동평균법과 달리 모든 시계열 자료를 사용하여 평균을 구하며, 시간의 흐름에 따라 최근 시계열에 더 많은 가중치를 부여하여 미래를 예측하는 방법

2) 특징
- 단기간에 발생하는 불규칙변동을 평활하는 방법
- 자료 수 만ㄹ고, 안정된 패턴을 보이는 경우 예측 품질 높음
- 지수평활법에서 가중치의 역할을 하는 것은 지수평활계수(a)이며, 불규착변동이 큰 시계열의 경우 지수평활계수는 작은 값을, 불규칙 변동이 작은 시계열의 경우 큰 값의 지수평활계수를 적용
- 일반적으로 0.05 < a < 0.3
- 지수평활계수는 예측오차(실제 관측치와 예측치 사이의 잔차제곱합)를 비교하여 예측오차가 가장 작은 값을 선택하는 것이 바람직
- 지수평활계수는 과거로 갈수록 지속적으로 감소함
- 지수평활법은 불규칙변동의 영향을 제거하는 효과가 있으며, 중기 예측 이상에 주로 사용
- 단, 단순지수 평활법의 경우 장기추세나 계절변동이 포함된 시계열 예측에는 적합하지 않음

### 시계열 모형
가. 자기회귀모형(AR모형)
1) 개념
- p시점 전의 자료가 현재 자료에 영향을 주는 특성을 자기상관성이라 하며, 자기회귀 모형이란 자기상관성을 시계열 모형으로 구성한 것
- 자기상관함수 : 시계열 데이터의 자기상관성을 파악하기 위한 함수
- 자기상관함수ACF는 빠르게 감소, 부분자기함수PACF는 어느 시점에서 절단점을 가진다
- (ACF가 빠르게 감소하고, PACF가 3 시점에서 절단점을 갖는 그래프가 있다면 2시점 전의 자료까지가 현재에 영향을 미치는 AR(2)모형)

나. 이동평균모형(MA모형)
- 시간이 지날수록 관측치 평균값이 지속적으로 증가하거나 감소하는 경향을 표현한 시계열모형
- 현 시점의 자료를 유한한 개수의 백색잡음의 결합으로 표현하기 때문에 언제나 정상성을 만족함
- 1차 이동평균 모형은 이동평균모형중에서 가장 간단한 모형으로 시계열이 같은 시점의 백색잡음과 바로 전 시점의 백색 잡음의 결합으로 이루어진 모형

- 2차 이동평균모형은 바로 전 시점의 백색잡음과 시차가 2인 백색잡음의 결합으로 이루어진 모형
- AR모형과 반대로 ACF에서 절단점을 갖고, PACF가 빠르게 감소한다

다. 자기회귀누적이동평균모형(ARIMA 모형)
- 자기회귀와 이동평균을 모두 고려하는 모형으로 과거값과 과거 예측 오차를 통해 현재값을 설명
- ARIMA 모형은 비정상 시계열 모형이므로 차분이나 변환을 통해 AR모형이나 MA모형, 이 둘을 합친 ARMA모형으로 정상화할 수 있다
- ARIMA 모형은 p, d, q의 세가지 차수가 있다. d는 차분의 횟수, p는 AR 모형, q는 MA모형과 관련이 있는 차수이다
- 시계열 Zt의 d번 차분한 시계열이 ARMA(p,q)모형이면, 시계열 Zt는 차수가 p,d,q인 ARIMA모형, 즉 ARIMA(p,d,q)모형을 갖는다고 한다
- d = 0 >> ARMA(p,q)모형, 정상성 만족 ( ARMA(0,0)일 경우 정상화가 불필요함)
- p = 0 >> IMA(d,q)모형, d번 차분하면 MA(q)모형을 따름
- q = 0 >> ARI(p,d)모형, d번 차분하면 AR(p)모형을 따름
// 예시. ARIMA 모형의 차수
ARIMA(0,1,1) >> 1 차분 후 MA(1)활용
ARIMA(1,1,0) >> 1 차분 후 AR(1)활용
ARIMA(1,1,2) >> 1 차분 후 AR(1), MA(2), ARMA(1,2) 선택활용 > 이런 경우 가장 간단한 모형이나 AIC를 적용하여 점수가 가장 낮은 모형 선정

//참고. 백색잡음
- 자기상관이 없는 시계열. **강한 정상성**
- 평균과 분산이 일정하고 어떠한 추세가 없는 대표정인 정상 시계열임
- 랜덤한 값들로 이루어진 데이터로 확률과정(확률변수인 시계열의 집합)이 서로 독립이며 동일한 분포를 가짐

라. 분해시계열
- 시계열에 영향을 주는 일반적인 요인을 시계열에서 분리해 분석하는 방법
- 회귀분석적인 방법을 주로 사용함
- 분해식의 일반적인 정의

| 구분  | 요인        | 설명                                                                               |
| --- | --------- | -------------------------------------------------------------------------------- |
| 추세  | 장기 변동 요인  | - 어떠한 경제, 자연적 이유의 영향으로 앞으로 나아갈 방향성 반영<br>- 자료가 오르거나 내리는 추세, 선형, 이차식 형태, 지수적 형태 등 |
| 계절  | 단기 변동 요인  | - 요일, 월,사계절, 분가 등 일덩 고덩된 기간에 따라 자료가 변함                                           |
| 순환  | 중장기 변동 요인 | - 경제적, 자연적 이유 없이 알려지지 않은 주기로 변화하는 자료                                             |
| 불규칙 | 설명 불가 요인  | - 어떠한 규칙 없이 예측 불가능한 변동<br>-위의 세 가지 요인으로 설명할 수 없는 오차에 해당하는 요인                     |
![[Pasted image 20240319184456.png]]

- ![[Pasted image 20240319184028.png]]
- ![[Pasted image 20240319184525.png]]

## 비모수 통계
*비모수 통계기법의 개념*
### 개요
- 통계적 검정에서 모집단의 모수에 대한 검정은 모수적 검정과 비모수적 검정으로 구분함

가. 모수적 방법
- 검정하고자 하는 **모집단의 분포에 대한 가정**을 하고, 그 가정하에서 검정통계량과 검정통계량의 분포를 유도해 검정을 실시하는 방법

나. 비모수적 방법
- 자료가 **추출된 모집단의 분포에 대한 아무 제약을 가하지 않고 검정을 실시**하는 검정방법
- 관측된 자료가 **특정 분포를 따른다고 가정할 수 없는 경우**에 이용
- 관측된 **자료의 수가 많지 않거나**(30개 미만) 자료가 개체간의 **서열관계를 나타내는 경우** 이용

다. 모수적 검정과 비모수 검정의 차이

|       | 모수적 검정                                | 비모수적 검정                                                                           |
| ----- | ------------------------------------- | --------------------------------------------------------------------------------- |
| 가설 설정 | 가정된 분포의 모수에 대해 가설 설정                  | **가정된 분포가 없으므로** 가설은 단지 '분포의 형태가 동일하다' 또는 '분포의 형태가 동일하지 않다'와 같이 **분포의 형태에 대해 설정** |
| 검정 방법 | 관측된 자료를 이용해 구한 **표본 평균, 표본 분산** 등을 이용 | 관측값의 절대적인 크기에 의존하지 않는 **관측값들의 순위**(rank)나 **두 관측 값 차이의 부호**등을 이용해 검정              |

라. 비모수 검정의 종류

| 변수 개수 | 변수 척도             | 비모수 검정                               | 목적                                           |
| ----- | ----------------- | ------------------------------------ | -------------------------------------------- |
| 1개    | 등간/비율             | Kolmogorov-Smirnov<br>(단일표본검정)       | 관찰값들의 분포 추정(표본 데이터가 이론적으로 가정된 확률분포를 따르는지 검정) |
|       | 서열화 자료            | **Sign Test**                        | 한 집단의 부호 비교                                  |
|       | (등간 이상으로 측정된      | **Wilcoxon Sign Rank Test**          | 한 집단의 차이(순위) 비교                              |
| 2개    | 자료를 서열척도로 전환한 자료) | Kolmogorov-Smirnov<br>(독립2표본검정)      | 두 집단의 분포가 동일한지 검정                            |
|       |                   | **Wilcoxon Sign Rank Test**          | 대응되는 두 집단의 차이(순위) 비교                         |
|       |                   | **Wilcoxon Rank  sum Test(독립2표본검정)** | 두 집단의 분포가 동일한지 검정                            |
|       |                   | **Mann-Whitney U 검정**                | 두 집단의 분포가 동일한지 검정                            |
|       |                   | Spearman's 상관분석                      | 두 연속형 변수 간의 관련성                              |
| 3개    |                   | **Kruskal-Wallis 검정**                | 세 집단 이상의 분포가 동일한지 검정                         |
|       |                   | Friedman 검정                          | 대응되는 두 집단 이상의 차이(순위)를 비교                     |
|       |                   | Kendall 검정                           | 여러 평가 내용들 간의 일치성 검토                          |

### Kolmogorov-Smirnov 검정(단일 표본)
가. 개념
- 단일 표본 Kolmogorov-Smirnov 검정은 관측치들이 정규분포, 포아송분포 등과 같은 특정한 분포를 따르는지에 대해 검정하는 방법
- 누적관측분포와 누적이론적 분포와의 가장 큰 차이(절대값에서)로부터 검정 통계량이 계산됨
- 많은 모수 통계기법은 데이터가 정규분포를 따른다는 것을 가정하는데 단일표본 Kolmogornov 검정은 이러한 가정을 검정하는데 유용하게 사용될 수 있다
- 많은 모수 통계기법은 데이터가 정규분포를 따른다는 것을 가정하는데 단일표본 Kolmogornov-Smirniov 검정은 이러한 가정을 검정하는데 유용하게 사용될 수 있다

나. 조건
- 데이터는 순위자료 이상이어야 하며, 연속적 분포를 가정할 수 있어야 한다

다. 가설
- 귀무가설 : 주어진 자료의 분포는 검정하고자 하는 분포를 따른다
- 대립가설 : 주어진 자료의 분포는 검정하고자 하는 분포를 따르지 않는다
- 검정통계량이 작을수록 귀무가설을 기각하지 못하게 된다

### 일표본 비모수 검정
가. 부호검정(Sign Test)
- 부호검정은 일표본 t-검정에서 정규성을 만족하지 못할 경우 사용되며, 평균이 아닌 위치모수(여기서는 중앙값)에 대한 검정 방법 (T-검정 대신 사용하기 위해서는 대칭성이 만족되어야 한다)
- 관측값과 설정한 기준값의 차이를 통해 부호(+,-)를 계산한 후 이를 바탕으로 검정통계량 값을 계산함
- 표본의 크기 n이 큰 경우 귀무가설 하에 성공확률이 1/2인 이항분포를 따르며 대표본 정규근사에 표준화된 통계량을 통해 검정이 가능

나. 윌콕슨의 부호 순위 검정 - 일표본
- 관측값과 설정한 기준값의 차이의 부호만 아니라 상대적 크기도 고려한 검정 방법
- 모집단의 중앙값을 중심으로 대칭인 연속분포에서 표본이 추출되었다고 가정함
- Zi - Xi-O0를 계산한 후, 이의 절댓값인 |Zi|의 순위를 바탕으로 검정통계량 값을 계산함

다. 일표본 비모수 검정 요약(표 읽고 넘어감)

### 이표본 비모수 검정
가. 윌콕슨의 부호 순위 검정 - 대응표본
- 대응표본 t-검정에서 표본의 크기 n이 작고 정규성을 만족하지 모하는 경우 사용되며, 두 모집단의 중심위치 차이에 대한 검정이다
- 단일 모집단으로부터의 랜덤표본을 통해 0이 아닌 두 표본의 차이의 절대 값  |Yi-Xi|의 순위를 계산하여 이를 바탕으로 검정통계량을 계산한다

나, 윌콕슨 순위합 검정
- 독립표본 t-검정에서 표본의 크기 n이 작고 정규성을 만족하지 못하는 경우 사용되며, 두 모집단의 중심위치 아이에 대한 검정이다
- 두 모집단으로부터 아래와 같은 서로 독립인 랜덤 표본을 통해 두 모집단의 분포는 동일하고 세모... 만큼 위치 변화가 있다는 가정하에서 가설을 검정한다

- 두 표본을 혼합한 후 순서대로 나열한 다음, 표본 Y들의 순위를 계산하여 이를 바탕으로 검정 통계량 계산

다. 만-휘트니 U 검정
- 윌콕슨의 순위합 검정과 검정통계량은 다르지만 동일한 가설을 진행함
- 최소한의 연속적 서열변인을 가정하여 두 표본을 혼합한 후 순서대로 나열한 집단별로 그 순위의 합을 계산하여 두 집단의 순위합 크기가 차이가 있는 지를 검정함
- (표 읽고 넘어감)


### 크루스칼 - 왈리스 H 검정
가. 설명
- 만-휘트니 U 검정을 확장한 것으로 세 집단 이상의 분포가 동일한지를 검정함
- **일원배치 분선분석**에서 표본의 크기 n이 작고 정규성을 만족하지 못할 경우 사용하며 등분산 여부와 상관없이 대신 사용됨

나. 검정통계량
- 여기서 n은 전체 표본 수, ni는 i번째 그룹의 포본 수, ... 읽고 넘어감
- 유의하다고 나올 경우, 사후검정은 두 군끼리 직접 만-휘트니 U 검정한 후 유의확률 alpha를 보정해서 결과를 해석
- 
//알아두기. 모수검정과 비모수검정 비교
![[Pasted image 20240320135633.png]]
https://blog.naver.com/15991962/220614133463
![[Pasted image 20240320135444.png]]![[Pasted image 20240320135652.png]]

### 런 검정(Run Test)
가. 개념
- 일련의 연속적인 관측값들이 임의적으로 나타난 것인지를 검정하는 방법으로서 우연성 검정이라고도 함. 표본의 독립성 검정을 위해서 관측값들이 얻어진 순서에 근거하는 비모수적 검정 방법
- 런은 한 종류의 부호 또는 한 집단이 시작하여 끝날 때까지의 한 덩어리를 말함. 즉 동일한 부호나 집단의 관측값이 연속적으로 이어진 것을 말함
- [AAABBABBBA] = > (AAA/BB/A/BBB/A)
- 만약 어떤 시계열이 양의 계열상관이 있으면 이전 시점의 값이 이후에도 지속되는 경향을 보이고 반대로 음의 계열상관이 있으면 이전의 값과 반대되는 값이 나오는 경향을 보임
- 관리도의 경우 관리도에 타점된 런, 즉 연속적으로 관측된 품질 특성 통계량이 특정한 경향이나 규칙을 갖고 있는지 조사하여 이상 유무를 검정할 수 있다
- 표본이 독립적이라는 것은 런이 중앙값 선을 어떻게 지나가느냐에 따라 결정할 수 있는데 다음과 같이 정의할 수 있다
- 런이 중앙선을 기준으로 해서 얼마나 빈번하게 교차하는 가를 볼 때, 교차가 매우 적게 일어나거나 너무 많이 일어나는 경우는 표본의 독립성이 보장된다고 할 수 없다
- 표본의 크기가 n이고 런의 수가 R인경우, 표본이 독립이라는 귀무가설이 참이라면 런의 수 R은 근사적으로 정규분포를 따르게 된다

나. 가설
귀무가설 : 일련의 관측치는 랜덤이다 (표본은 독립이다)
대립가설 : 일련의 관측치는 랜덤이 아니다 (표본은 독립적이지 않다)

